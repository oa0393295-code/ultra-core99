<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„ØµØ­Ø§Ø¨ ğŸ“š</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, collection, getDocs, updateDoc, onSnapshot, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyASLT_wouo9BTjd-dH18x8CLbqBZSMbz04",
    authDomain: "ultra-core.firebaseapp.com",
    projectId: "ultra-core",
    storageBucket: "ultra-core.firebasestorage.app",
    messagingSenderId: "351766462712",
    appId: "1:351766462712:web:e683d8aa0d213b6e59fb0d",
    measurementId: "G-8RVTD75KCP"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const provider = new GoogleAuthProvider();

  let currentUser = null;
  let studyTimer = null;
  let studyStartTime = null;
  let studySeconds = 0;
  let isStudying = false;
  let todayData = {};
  let allUsersUnsub = null;

  const TODAY = () => new Date().toISOString().split('T')[0];

  // ==================== AUTH ====================
  window.googleSignIn = async () => {
    try {
      showLoading(true);
      const result = await signInWithPopup(auth, provider);
    } catch (e) {
      console.error(e);
      showLoading(false);
      showToast('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø­Ø§ÙˆÙ„ ØªØ§Ù†ÙŠ!', 'error');
    }
  };

  window.googleSignOut = async () => {
    if (isStudying) await stopStudy();
    await updateUserStatus('offline');
    await signOut(auth);
  };

  onAuthStateChanged(auth, async (user) => {
    if (user) {
      currentUser = user;
      await initUser(user);
      showApp();
      loadTodayData();
      startRealtimeLeaderboard();
      await updateUserStatus('online');
      setInterval(() => updateUserStatus(isStudying ? 'studying' : 'online'), 30000);
    } else {
      currentUser = null;
      showLogin();
      if (allUsersUnsub) allUsersUnsub();
    }
  });

  async function initUser(user) {
    const ref = doc(db, 'users', user.uid);
    const snap = await getDoc(ref);
    if (!snap.exists()) {
      await setDoc(ref, {
        uid: user.uid,
        name: user.displayName,
        photo: user.photoURL,
        status: 'online',
        lastSeen: serverTimestamp(),
        createdAt: serverTimestamp()
      });
    } else {
      await updateDoc(ref, { name: user.displayName, photo: user.photoURL });
    }
    document.getElementById('userAvatar').src = user.photoURL || '';
    document.getElementById('userName').textContent = user.displayName;
  }

  async function updateUserStatus(status) {
    if (!currentUser) return;
    try {
      await updateDoc(doc(db, 'users', currentUser.uid), {
        status,
        lastSeen: serverTimestamp()
      });
    } catch (e) {}
  }

  // ==================== TODAY DATA ====================
  async function loadTodayData() {
    if (!currentUser) return;
    const ref = doc(db, 'logs', currentUser.uid, 'days', TODAY());
    const snap = await getDoc(ref);
    if (snap.exists()) {
      todayData = snap.data();
    } else {
      todayData = { prayers: [], quranPages: 0, studySeconds: 0, date: TODAY() };
    }
    renderTodayUI();
    studySeconds = todayData.studySeconds || 0;
    updateTimerDisplay();
  }

  async function saveTodayData() {
    if (!currentUser) return;
    const ref = doc(db, 'logs', currentUser.uid, 'days', TODAY());
    await setDoc(ref, { ...todayData, uid: currentUser.uid, name: currentUser.displayName, photo: currentUser.photoURL, updatedAt: serverTimestamp() });
    await updateDoc(doc(db, 'users', currentUser.uid), {
      todayStudySeconds: todayData.studySeconds || 0,
      todayPrayers: todayData.prayers || [],
      todayQuranPages: todayData.quranPages || 0,
      todayDate: TODAY()
    });
  }

  function renderTodayUI() {
    const prayers = todayData.prayers || [];
    document.querySelectorAll('.prayer-btn').forEach(btn => {
      const p = btn.dataset.prayer;
      btn.classList.toggle('active', prayers.includes(p));
    });
    document.getElementById('quranInput').value = todayData.quranPages || 0;
  }

  // ==================== PRAYERS ====================
  window.togglePrayer = async (prayer) => {
    let prayers = todayData.prayers || [];
    if (prayers.includes(prayer)) {
      prayers = prayers.filter(p => p !== prayer);
    } else {
      prayers.push(prayer);
      triggerPrayerEffect();
    }
    todayData.prayers = prayers;
    await saveTodayData();
    renderTodayUI();
    updateMyStats();
  };

  function triggerPrayerEffect() {
    const btn = event.currentTarget;
    btn.style.transform = 'scale(1.3)';
    setTimeout(() => btn.style.transform = '', 300);
    spawnParticles(btn);
  }

  // ==================== QURAN ====================
  window.saveQuran = async () => {
    const val = parseInt(document.getElementById('quranInput').value) || 0;
    todayData.quranPages = Math.max(0, val);
    await saveTodayData();
    showToast(`âœ… ØªÙ… Ø­ÙØ¸ ${val} ØµÙØ­Ø©`, 'success');
    updateMyStats();
  };

  // ==================== STUDY TIMER ====================
  window.toggleStudy = async () => {
    if (!isStudying) {
      await startStudy();
    } else {
      await stopStudy();
    }
  };

  async function startStudy() {
    isStudying = true;
    studyStartTime = Date.now() - (studySeconds * 1000);
    await updateUserStatus('studying');
    document.getElementById('timerBtn').textContent = 'â¸ Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª';
    document.getElementById('timerBtn').classList.add('studying');
    document.getElementById('timerStatus').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©...';
    document.getElementById('timerStatus').classList.add('active');

    studyTimer = setInterval(async () => {
      studySeconds = Math.floor((Date.now() - studyStartTime) / 1000);
      updateTimerDisplay();
      if (studySeconds % 30 === 0) {
        todayData.studySeconds = studySeconds;
        await saveTodayData();
      }
    }, 1000);
  }

  async function stopStudy() {
    isStudying = false;
    clearInterval(studyTimer);
    todayData.studySeconds = studySeconds;
    await saveTodayData();
    await updateUserStatus('online');
    document.getElementById('timerBtn').textContent = 'â–¶ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©';
    document.getElementById('timerBtn').classList.remove('studying');
    document.getElementById('timerStatus').textContent = 'ÙˆÙ‚Ù';
    document.getElementById('timerStatus').classList.remove('active');
    updateMyStats();
    showToast('âœ… ØªÙ… Ø­ÙØ¸ ÙˆÙ‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©!', 'success');
  }

  function updateTimerDisplay() {
    const h = Math.floor(studySeconds / 3600);
    const m = Math.floor((studySeconds % 3600) / 60);
    const s = studySeconds % 60;
    document.getElementById('timerHours').textContent = String(h).padStart(2, '0');
    document.getElementById('timerMins').textContent = String(m).padStart(2, '0');
    document.getElementById('timerSecs').textContent = String(s).padStart(2, '0');

    // Update circle progress (max 8 hours)
    const pct = Math.min(studySeconds / (8 * 3600), 1);
    const circle = document.getElementById('timerCircle');
    const circumference = 2 * Math.PI * 90;
    circle.style.strokeDashoffset = circumference * (1 - pct);
  }

  function updateMyStats() {
    const hours = (studySeconds / 3600).toFixed(1);
    document.getElementById('myStudyHours').textContent = hours + 'h';
    document.getElementById('myPrayersCount').textContent = (todayData.prayers || []).length + '/6';
    document.getElementById('myQuranPages').textContent = (todayData.quranPages || 0);
  }

  // ==================== LEADERBOARD ====================
  function startRealtimeLeaderboard() {
    const usersRef = collection(db, 'users');
    allUsersUnsub = onSnapshot(usersRef, (snapshot) => {
      const users = [];
      snapshot.forEach(doc => users.push({ id: doc.id, ...doc.data() }));
      renderLeaderboards(users);
    });
  }

  function renderLeaderboards(users) {
    const today = TODAY();

    const withToday = users.map(u => ({
      ...u,
      studySecs: u.todayDate === today ? (u.todayStudySeconds || 0) : 0,
      prayers: u.todayDate === today ? (u.todayPrayers || []) : [],
      quranPages: u.todayDate === today ? (u.todayQuranPages || 0) : 0,
    }));

    // Study leaderboard
    const byStudy = [...withToday].sort((a, b) => b.studySecs - a.studySecs);
    renderBoard('studyBoard', byStudy, u => {
      const h = Math.floor(u.studySecs / 3600);
      const m = Math.floor((u.studySecs % 3600) / 60);
      return `${h}h ${m}m`;
    }, u => u.studySecs);

    // Prayers leaderboard
    const byPrayers = [...withToday].sort((a, b) => b.prayers.length - a.prayers.length);
    renderBoard('prayersBoard', byPrayers, u => `${u.prayers.length} / 6 ØµÙ„ÙˆØ§Øª`, u => u.prayers.length / 6);

    // Quran leaderboard
    const byQuran = [...withToday].sort((a, b) => b.quranPages - a.quranPages);
    renderBoard('quranBoard', byQuran, u => `${u.quranPages} ØµÙØ­Ø©`, u => u.quranPages);

    // Friends status
    renderFriendsStatus(withToday);
  }

  function renderBoard(containerId, users, valueFn, progressFn) {
    const container = document.getElementById(containerId);
    const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
    const maxVal = Math.max(...users.map(progressFn), 1);

    container.innerHTML = users.slice(0, 10).map((u, i) => {
      const isMe = u.id === currentUser?.uid;
      const pct = Math.round((progressFn(u) / maxVal) * 100);
      return `
        <div class="board-row ${isMe ? 'me' : ''}" onclick="openUserLog('${u.id}','${(u.name||'').replace(/'/g,"\\'")}')">
          <div class="board-rank">${medals[i] || '#' + (i+1)}</div>
          <img class="board-avatar" src="${u.photo || ''}" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 40 40%22><rect fill=%22%23333%22 width=%2240%22 height=%2240%22/><text x=%2250%25%22 y=%2255%25%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 fill=%22white%22 font-size=%2218%22>${(u.name||'?')[0]}</text></svg>'">
          <div class="board-info">
            <div class="board-name">${u.name || 'Ù…Ø¬Ù‡ÙˆÙ„'} ${isMe ? '(Ø£Ù†Ø§)' : ''}</div>
            <div class="board-progress-bar"><div class="board-progress-fill" style="width:${pct}%"></div></div>
          </div>
          <div class="board-value">${valueFn(u)}</div>
        </div>`;
    }).join('') || '<div class="empty-board">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>';
  }

  function renderFriendsStatus(users) {
    const container = document.getElementById('friendsStatus');
    const statusMap = { studying: { icon: 'ğŸ“š', label: 'Ø¨ÙŠØ°Ø§ÙƒØ±', color: '#00e676' }, online: { icon: 'ğŸŸ¢', label: 'Ù…ØªØµÙ„', color: '#4fc3f7' }, offline: { icon: 'â­•', label: 'Ù…Ø´ Ù…ØªØµÙ„', color: '#666' } };
    container.innerHTML = users.map(u => {
      const st = statusMap[u.status] || statusMap.offline;
      const isMe = u.id === currentUser?.uid;
      return `
        <div class="friend-status-card ${isMe ? 'me' : ''}">
          <img src="${u.photo || ''}" class="friend-photo" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 40 40%22><rect fill=%22%23333%22 width=%2240%22 height=%2240%22/></svg>'">
          <div class="friend-status-dot" style="background:${st.color}; ${u.status === 'studying' ? 'animation: statusPulse 1.5s infinite;' : ''}"></div>
          <div class="friend-name-text">${u.name?.split(' ')[0] || 'ØŸ'} ${isMe ? '(Ø£Ù†Ø§)' : ''}</div>
          <div class="friend-status-label" style="color:${st.color}">${st.icon} ${st.label}</div>
        </div>`;
    }).join('');
  }

  // ==================== USER LOG ====================
  window.openUserLog = async (uid, name) => {
    document.getElementById('logModal').style.display = 'flex';
    document.getElementById('logModalTitle').textContent = `ğŸ“‹ Ø³Ø¬Ù„ ${name}`;
    document.getElementById('logContent').innerHTML = '<div class="log-loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';

    try {
      const logsRef = collection(db, 'logs', uid, 'days');
      const q = query(logsRef, orderBy('date', 'desc'));
      const snap = await getDocs(q);

      const days = [];
      snap.forEach(d => days.push(d.data()));

      if (!days.length) {
        document.getElementById('logContent').innerHTML = '<div class="log-empty">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª</div>';
        return;
      }

      const isMe = uid === currentUser?.uid;

      document.getElementById('logContent').innerHTML = days.map(day => {
        const h = Math.floor((day.studySeconds || 0) / 3600);
        const m = Math.floor(((day.studySeconds || 0) % 3600) / 60);
        const prayers = day.prayers || [];
        const isToday = day.date === TODAY();

        return `
          <div class="log-day-card ${isToday ? 'today' : ''}">
            <div class="log-day-header">
              <span class="log-date">${formatDate(day.date)} ${isToday ? 'ğŸ”µ Ø§Ù„ÙŠÙˆÙ…' : ''}</span>
              ${isMe && isToday ? `<button class="edit-log-btn" onclick="openEditLog()">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>` : ''}
            </div>
            <div class="log-stats-row">
              <div class="log-stat"><span class="log-stat-icon">ğŸ“š</span><span>${h}h ${m}m Ù…Ø°Ø§ÙƒØ±Ø©</span></div>
              <div class="log-stat"><span class="log-stat-icon">ğŸ•Œ</span><span>${prayers.length}/6 ØµÙ„ÙˆØ§Øª</span></div>
              <div class="log-stat"><span class="log-stat-icon">ğŸ“–</span><span>${day.quranPages || 0} ØµÙØ­Ø©</span></div>
            </div>
            <div class="log-prayers-row">${['Ø§Ù„ÙØ¬Ø±','Ø§Ù„Ø¸Ù‡Ø±','Ø§Ù„Ø¹ØµØ±','Ø§Ù„Ù…ØºØ±Ø¨','Ø§Ù„Ø¹Ø´Ø§Ø¡','Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­'].map(p => `<span class="log-prayer-badge ${prayers.includes(p) ? 'done' : ''}">${p}</span>`).join('')}</div>
          </div>`;
      }).join('');
    } catch (e) {
      document.getElementById('logContent').innerHTML = '<div class="log-empty">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</div>';
    }
  };

  window.closeLogModal = () => { document.getElementById('logModal').style.display = 'none'; };

  window.openEditLog = () => {
    document.getElementById('editModal').style.display = 'flex';
    const d = todayData;
    ['Ø§Ù„ÙØ¬Ø±','Ø§Ù„Ø¸Ù‡Ø±','Ø§Ù„Ø¹ØµØ±','Ø§Ù„Ù…ØºØ±Ø¨','Ø§Ù„Ø¹Ø´Ø§Ø¡','Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­'].forEach(p => {
      const el = document.getElementById('edit_' + p);
      if (el) el.checked = (d.prayers || []).includes(p);
    });
    document.getElementById('editQuran').value = d.quranPages || 0;
    document.getElementById('editStudy').value = Math.floor((d.studySeconds || 0) / 3600 * 100) / 100;
  };

  window.saveEditLog = async () => {
    const prayers = ['Ø§Ù„ÙØ¬Ø±','Ø§Ù„Ø¸Ù‡Ø±','Ø§Ù„Ø¹ØµØ±','Ø§Ù„Ù…ØºØ±Ø¨','Ø§Ù„Ø¹Ø´Ø§Ø¡','Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­'].filter(p => {
      const el = document.getElementById('edit_' + p);
      return el && el.checked;
    });
    const pages = parseInt(document.getElementById('editQuran').value) || 0;
    const hours = parseFloat(document.getElementById('editStudy').value) || 0;

    todayData.prayers = prayers;
    todayData.quranPages = pages;
    todayData.studySeconds = Math.round(hours * 3600);
    studySeconds = todayData.studySeconds;

    await saveTodayData();
    renderTodayUI();
    updateTimerDisplay();
    updateMyStats();
    document.getElementById('editModal').style.display = 'none';
    closeLogModal();
    showToast('âœ… ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„!', 'success');
  };

  window.closeEditModal = () => { document.getElementById('editModal').style.display = 'none'; };

  // ==================== HELPERS ====================
  function formatDate(dateStr) {
    if (!dateStr) return '';
    const d = new Date(dateStr);
    return d.toLocaleDateString('ar-EG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
  }

  window.showLoading = (show) => {
    document.getElementById('loginLoading').style.display = show ? 'block' : 'none';
  };

  window.showToast = (msg, type = 'info') => {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.className = 'toast show ' + type;
    setTimeout(() => t.className = 'toast', 3000);
  };

  function showLogin() {
    document.getElementById('loginPage').style.display = 'flex';
    document.getElementById('appPage').style.display = 'none';
    showLoading(false);
  }

  function showApp() {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('appPage').style.display = 'block';
    showLoading(false);
  }

  function spawnParticles(el) {
    const rect = el.getBoundingClientRect();
    for (let i = 0; i < 8; i++) {
      const p = document.createElement('div');
      p.className = 'particle';
      p.style.left = (rect.left + rect.width/2) + 'px';
      p.style.top = (rect.top + rect.height/2) + 'px';
      const angle = (i / 8) * 360;
      const dist = 40 + Math.random() * 30;
      const dx = Math.cos(angle * Math.PI/180) * dist;
      const dy = Math.sin(angle * Math.PI/180) * dist;
      p.style.setProperty('--dx', dx + 'px');
      p.style.setProperty('--dy', dy + 'px');
      document.body.appendChild(p);
      setTimeout(() => p.remove(), 700);
    }
  }

  window.addEventListener('beforeunload', () => {
    if (isStudying) stopStudy();
    updateUserStatus('offline');
  });
</script>

<style>
:root {
  --bg: #060610;
  --glass: rgba(255,255,255,0.04);
  --glass-border: rgba(255,255,255,0.1);
  --accent: #4fc3f7;
  --accent2: #ce93d8;
  --gold: #ffd54f;
  --green: #69f0ae;
  --text: #e8eaf6;
  --sub: #90a4ae;
  --radius: 20px;
}

* { margin:0; padding:0; box-sizing:border-box; }
html { scroll-behavior: smooth; }

body {
  font-family: 'Cairo', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ===== ANIMATED BG ===== */
.bg-orbs {
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  overflow: hidden;
}
.orb {
  position: absolute; border-radius: 50%;
  filter: blur(80px); opacity: 0.15;
  animation: orbFloat linear infinite;
}
.orb1 { width:600px;height:600px; background:#4fc3f7; top:-200px;right:-200px; animation-duration:20s; }
.orb2 { width:500px;height:500px; background:#ce93d8; bottom:-150px;left:-150px; animation-duration:25s; animation-delay:-10s; }
.orb3 { width:400px;height:400px; background:#69f0ae; top:50%;left:50%; animation-duration:18s; animation-delay:-5s; }

@keyframes orbFloat {
  0%,100% { transform: translate(0,0) scale(1); }
  33% { transform: translate(30px,-30px) scale(1.05); }
  66% { transform: translate(-20px,20px) scale(0.95); }
}

.grid-bg {
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background-image:
    linear-gradient(rgba(79,195,247,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(79,195,247,0.03) 1px, transparent 1px);
  background-size: 60px 60px;
}

/* ===== LOGIN PAGE ===== */
#loginPage {
  display: flex; align-items: center; justify-content: center;
  min-height: 100vh; position: relative; z-index: 10;
  flex-direction: column; gap: 2rem;
  padding: 2rem;
}

.login-card {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.12);
  backdrop-filter: blur(40px);
  border-radius: 28px;
  padding: 3rem 2.5rem;
  text-align: center;
  max-width: 420px;
  width: 100%;
  box-shadow: 0 0 80px rgba(79,195,247,0.08), inset 0 1px 0 rgba(255,255,255,0.1);
  animation: fadeInUp 0.8s ease both;
}

@keyframes fadeInUp {
  from { opacity:0; transform:translateY(30px); }
  to { opacity:1; transform:translateY(0); }
}

.login-logo { font-size: 4rem; margin-bottom: 1rem; animation: float 3s ease-in-out infinite; }
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }

.login-title {
  font-size: 2rem; font-weight: 900;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  margin-bottom: 0.5rem;
}
.login-sub { color: var(--sub); font-size: 0.95rem; margin-bottom: 2rem; line-height: 1.8; }

.google-btn {
  display: flex; align-items: center; justify-content: center; gap: 0.75rem;
  width: 100%; padding: 0.9rem 1.5rem;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 14px; color: var(--text);
  font-family: 'Cairo', sans-serif; font-size: 1rem; font-weight: 700;
  cursor: pointer; transition: all 0.3s;
}
.google-btn:hover {
  background: rgba(255,255,255,0.14);
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(79,195,247,0.2);
}
.google-btn img { width: 22px; }

#loginLoading { display:none; margin-top:1rem; color:var(--sub); }

/* ===== APP PAGE ===== */
#appPage { display: none; position: relative; z-index: 5; }

/* ===== NAVBAR ===== */
nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(6,6,16,0.8);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(255,255,255,0.07);
  padding: 0.8rem 1.5rem;
  display: flex; align-items: center; justify-content: space-between;
}

.nav-logo { font-size: 1.2rem; font-weight: 900; background: linear-gradient(135deg, var(--accent), var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

.nav-user { display: flex; align-items: center; gap: 0.75rem; }
.nav-avatar { width: 36px; height: 36px; border-radius: 50%; border: 2px solid var(--accent); }
#userName { font-size: 0.9rem; color: var(--sub); }

.sign-out-btn {
  background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px; padding: 0.4rem 0.9rem; color: var(--sub);
  font-family: 'Cairo', sans-serif; font-size: 0.82rem; cursor: pointer;
  transition: all 0.2s;
}
.sign-out-btn:hover { background: rgba(255,100,100,0.15); color: #ff6b6b; border-color: rgba(255,100,100,0.3); }

/* ===== TABS ===== */
.tab-bar {
  display: flex; gap: 0.5rem; padding: 1rem 1.5rem 0;
  overflow-x: auto; scrollbar-width: none;
}
.tab-bar::-webkit-scrollbar { display: none; }

.tab-btn {
  padding: 0.55rem 1.3rem; border-radius: 30px;
  border: 1px solid rgba(255,255,255,0.1);
  background: transparent; color: var(--sub);
  font-family: 'Cairo', sans-serif; font-size: 0.88rem;
  cursor: pointer; transition: all 0.25s; white-space: nowrap;
}
.tab-btn.active {
  background: linear-gradient(135deg, rgba(79,195,247,0.2), rgba(206,147,216,0.2));
  border-color: var(--accent); color: var(--accent);
}

/* ===== MAIN LAYOUT ===== */
.main-content { padding: 1.5rem; max-width: 1200px; margin: 0 auto; }
.tab-section { display: none; }
.tab-section.active { display: block; animation: fadeInUp 0.4s ease both; }

/* ===== GLASS CARD ===== */
.glass-card {
  background: var(--glass);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(30px);
  border-radius: var(--radius);
  padding: 1.5rem;
  box-shadow: 0 4px 40px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
  transition: box-shadow 0.3s;
}
.glass-card:hover { box-shadow: 0 4px 40px rgba(79,195,247,0.08), inset 0 1px 0 rgba(255,255,255,0.05); }

/* ===== SECTION TITLE ===== */
.section-title {
  font-size: 1.2rem; font-weight: 700; margin-bottom: 1.2rem;
  color: var(--text); display: flex; align-items: center; gap: 0.6rem;
}
.section-title .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); }

/* ===== MY STATS MINI ===== */
.my-stats-row {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem;
  margin-bottom: 1.5rem;
}
.my-stat-card {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 14px; padding: 0.9rem; text-align: center;
}
.my-stat-num { font-size: 1.4rem; font-weight: 900; color: var(--accent); }
.my-stat-label { font-size: 0.7rem; color: var(--sub); margin-top: 2px; }

/* ===== TIMER ===== */
.timer-section { display: flex; flex-direction: column; align-items: center; gap: 1.5rem; }

.timer-circle-wrap { position: relative; width: 220px; height: 220px; }
.timer-svg { transform: rotate(-90deg); }
.timer-track { fill: none; stroke: rgba(255,255,255,0.06); stroke-width: 8; }
#timerCircle {
  fill: none; stroke: url(#timerGrad); stroke-width: 8;
  stroke-linecap: round;
  stroke-dasharray: 565.5; stroke-dashoffset: 565.5;
  transition: stroke-dashoffset 1s linear;
}

.timer-inner {
  position: absolute; inset: 0; display: flex; flex-direction: column;
  align-items: center; justify-content: center; gap: 4px;
}
.timer-digits { font-size: 2.2rem; font-weight: 900; font-variant-numeric: tabular-nums; letter-spacing: -2px; }
#timerStatus { font-size: 0.75rem; color: var(--sub); }
#timerStatus.active { color: var(--green); animation: pulse 2s infinite; }

@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.5} }

.timer-btn {
  padding: 0.75rem 2.5rem; border-radius: 14px;
  background: linear-gradient(135deg, rgba(79,195,247,0.2), rgba(206,147,216,0.2));
  border: 1px solid var(--accent);
  color: var(--accent); font-family: 'Cairo', sans-serif;
  font-size: 1rem; font-weight: 700; cursor: pointer;
  transition: all 0.3s;
}
.timer-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 24px rgba(79,195,247,0.3); }
.timer-btn.studying {
  background: linear-gradient(135deg, rgba(105,240,174,0.2), rgba(79,195,247,0.2));
  border-color: var(--green); color: var(--green);
  animation: studyGlow 2s infinite;
}
@keyframes studyGlow { 0%,100%{box-shadow:0 0 10px rgba(105,240,174,0.2)} 50%{box-shadow:0 0 25px rgba(105,240,174,0.5)} }

/* ===== PRAYERS ===== */
.prayers-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; }
.prayer-btn {
  padding: 1rem 0.5rem; border-radius: 14px;
  background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08);
  color: var(--sub); font-family: 'Cairo', sans-serif; font-size: 0.9rem; font-weight: 600;
  cursor: pointer; transition: all 0.3s; text-align: center;
}
.prayer-btn.active {
  background: linear-gradient(135deg, rgba(105,240,174,0.15), rgba(79,195,247,0.15));
  border-color: var(--green); color: var(--green);
  box-shadow: 0 0 20px rgba(105,240,174,0.15);
}
.prayer-btn:hover { transform: translateY(-2px); }

/* ===== QURAN ===== */
.quran-input-wrap { display: flex; gap: 0.75rem; align-items: center; }
.quran-input {
  flex: 1; background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.12); border-radius: 12px;
  padding: 0.7rem 1rem; color: var(--text);
  font-family: 'Cairo', sans-serif; font-size: 1rem; outline: none;
  transition: border-color 0.3s;
}
.quran-input:focus { border-color: var(--accent2); }
.save-btn {
  padding: 0.7rem 1.4rem; border-radius: 12px;
  background: linear-gradient(135deg, rgba(206,147,216,0.3), rgba(79,195,247,0.2));
  border: 1px solid var(--accent2); color: var(--accent2);
  font-family: 'Cairo', sans-serif; font-size: 0.9rem; font-weight: 700;
  cursor: pointer; transition: all 0.3s;
}
.save-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(206,147,216,0.3); }

/* ===== LEADERBOARD BOARDS ===== */
.boards-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
@media(min-width:768px) { .boards-grid { grid-template-columns: 1fr 1fr; } }

.board-title { font-size: 1rem; font-weight: 700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }

.board-row {
  display: flex; align-items: center; gap: 0.75rem;
  padding: 0.7rem 0.5rem; border-radius: 12px;
  transition: background 0.2s; cursor: pointer;
}
.board-row:hover { background: rgba(255,255,255,0.04); }
.board-row.me { background: rgba(79,195,247,0.05); border: 1px solid rgba(79,195,247,0.15); border-radius: 12px; }

.board-rank { font-size: 1.2rem; width: 30px; text-align: center; flex-shrink: 0; }
.board-avatar { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; flex-shrink: 0; }
.board-info { flex: 1; }
.board-name { font-size: 0.88rem; font-weight: 600; }
.board-progress-bar { height: 3px; background: rgba(255,255,255,0.06); border-radius: 99px; margin-top: 4px; overflow: hidden; }
.board-progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2)); border-radius: 99px; transition: width 0.6s ease; }
.board-value { font-size: 0.82rem; color: var(--gold); font-weight: 700; flex-shrink: 0; white-space: nowrap; }
.empty-board { text-align: center; color: var(--sub); padding: 1.5rem; font-size: 0.9rem; }

/* ===== FRIENDS STATUS ===== */
.friends-grid { display: flex; flex-wrap: wrap; gap: 1rem; }
.friend-status-card {
  display: flex; flex-direction: column; align-items: center; gap: 0.4rem;
  background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.07);
  border-radius: 16px; padding: 1rem 1.2rem; min-width: 100px;
  transition: all 0.3s; position: relative;
}
.friend-status-card.me { border-color: rgba(79,195,247,0.25); }
.friend-status-card:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(0,0,0,0.2); }

.friend-photo { width: 52px; height: 52px; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.1); }
.friend-status-dot {
  width: 12px; height: 12px; border-radius: 50%;
  position: absolute; bottom: 38px; right: 16px;
  border: 2px solid var(--bg);
}
.friend-name-text { font-size: 0.82rem; font-weight: 700; text-align: center; }
.friend-status-label { font-size: 0.73rem; text-align: center; }

@keyframes statusPulse {
  0%,100%{box-shadow:0 0 0 0 rgba(105,240,174,0.6)}
  50%{box-shadow:0 0 0 5px rgba(105,240,174,0)}
}

/* ===== MODAL ===== */
.modal {
  display: none; position: fixed; inset: 0; z-index: 200;
  background: rgba(0,0,0,0.7); backdrop-filter: blur(10px);
  align-items: center; justify-content: center; padding: 1rem;
}
.modal-box {
  background: #0d0d1f;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 24px; padding: 1.5rem;
  max-width: 560px; width: 100%;
  max-height: 80vh; display: flex; flex-direction: column;
  box-shadow: 0 0 60px rgba(79,195,247,0.1);
  animation: fadeInUp 0.3s ease both;
}
.modal-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; }
.modal-header h3 { font-size: 1.1rem; font-weight: 700; }
.modal-close { background:none;border:none;color:var(--sub);font-size:1.4rem;cursor:pointer; }
.modal-body { overflow-y: auto; flex: 1; scrollbar-width: thin; }

/* ===== LOG DAY CARD ===== */
.log-day-card {
  background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.07);
  border-radius: 14px; padding: 1rem; margin-bottom: 0.75rem;
}
.log-day-card.today { border-color: rgba(79,195,247,0.3); }
.log-day-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.7rem; }
.log-date { font-size: 0.85rem; font-weight: 700; color: var(--accent); }
.log-stats-row { display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 0.6rem; }
.log-stat { display: flex; align-items: center; gap: 0.3rem; font-size: 0.82rem; color: var(--sub); }
.log-stat-icon { font-size: 1rem; }
.log-prayers-row { display: flex; flex-wrap: wrap; gap: 0.4rem; }
.log-prayer-badge {
  padding: 0.2rem 0.6rem; border-radius: 20px;
  background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08);
  font-size: 0.72rem; color: var(--sub);
}
.log-prayer-badge.done { background: rgba(105,240,174,0.1); border-color: rgba(105,240,174,0.3); color: var(--green); }

.edit-log-btn {
  background: rgba(79,195,247,0.1); border: 1px solid rgba(79,195,247,0.2);
  border-radius: 8px; padding: 0.25rem 0.7rem; color: var(--accent);
  font-family: 'Cairo', sans-serif; font-size: 0.78rem; cursor: pointer;
  transition: all 0.2s;
}
.edit-log-btn:hover { background: rgba(79,195,247,0.2); }

.log-loading, .log-empty { text-align: center; color: var(--sub); padding: 2rem; }

/* ===== EDIT MODAL ===== */
.edit-checks { display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem; margin-bottom: 1rem; }
.edit-check-item {
  display: flex; align-items: center; gap: 0.5rem;
  background: rgba(255,255,255,0.04); border-radius: 10px; padding: 0.6rem 0.8rem;
  cursor: pointer; font-size: 0.9rem;
}
.edit-check-item input { width: 16px; height: 16px; cursor: pointer; accent-color: var(--green); }
.edit-field { margin-bottom: 0.8rem; }
.edit-label { font-size: 0.82rem; color: var(--sub); margin-bottom: 0.4rem; display: block; }
.edit-input {
  width: 100%; background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.12); border-radius: 10px;
  padding: 0.6rem 0.9rem; color: var(--text);
  font-family: 'Cairo', sans-serif; font-size: 0.95rem; outline: none;
}
.edit-input:focus { border-color: var(--accent); }
.save-edit-btn {
  width: 100%; padding: 0.8rem; border-radius: 12px;
  background: linear-gradient(135deg, rgba(79,195,247,0.25), rgba(206,147,216,0.25));
  border: 1px solid var(--accent); color: var(--accent);
  font-family: 'Cairo', sans-serif; font-size: 1rem; font-weight: 700;
  cursor: pointer; transition: all 0.3s;
}
.save-edit-btn:hover { box-shadow: 0 4px 20px rgba(79,195,247,0.3); }

/* ===== TOAST ===== */
.toast {
  position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(80px);
  background: rgba(20,20,40,0.95); border: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(20px); border-radius: 12px;
  padding: 0.75rem 1.5rem; font-size: 0.9rem; font-weight: 600;
  z-index: 999; transition: transform 0.3s ease; white-space: nowrap;
}
.toast.show { transform: translateX(-50%) translateY(0); }
.toast.success { border-color: rgba(105,240,174,0.4); color: var(--green); }
.toast.error { border-color: rgba(255,100,100,0.4); color: #ff6b6b; }

/* ===== PARTICLES ===== */
.particle {
  position: fixed; width: 8px; height: 8px; border-radius: 50%;
  background: var(--green); pointer-events: none; z-index: 9999;
  animation: particleFly 0.7s ease forwards;
}
@keyframes particleFly {
  0% { opacity: 1; transform: translate(0,0) scale(1); }
  100% { opacity: 0; transform: translate(var(--dx), var(--dy)) scale(0); }
}

/* ===== GRID LAYOUT ===== */
.input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
@media(max-width:640px) { .input-grid { grid-template-columns: 1fr; } }

.gap-md { display: flex; flex-direction: column; gap: 1.5rem; }

/* ===== SCROLLBAR ===== */
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }
</style>
</head>
<body>

<!-- BG Effects -->
<div class="bg-orbs">
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>
  <div class="orb orb3"></div>
</div>
<div class="grid-bg"></div>

<!-- ==================== LOGIN PAGE ==================== -->
<div id="loginPage">
  <div class="login-card">
    <div class="login-logo">ğŸ“š</div>
    <div class="login-title">Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„ØµØ­Ø§Ø¨</div>
    <div class="login-sub">
      ØªØ§Ø¨Ø¹ Ù…Ø°Ø§ÙƒØ±ØªÙƒ ÙˆØµÙ„ÙˆØ§ØªÙƒ ÙˆÙ‚Ø±Ø¢Ù†Ùƒ<br>
      ÙˆØªÙ†Ø§ÙØ³ Ù…Ø¹ Ø£ØµØ­Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
    </div>
    <button class="google-btn" onclick="googleSignIn()">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
      Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google
    </button>
    <div id="loginLoading">â³ Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...</div>
  </div>
</div>

<!-- ==================== APP PAGE ==================== -->
<div id="appPage">

  <!-- Navbar -->
  <nav>
    <div class="nav-logo">ğŸ“š Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„ØµØ­Ø§Ø¨</div>
    <div class="nav-user">
      <img id="userAvatar" class="nav-avatar" src="" alt="">
      <span id="userName"></span>
      <button class="sign-out-btn" onclick="googleSignOut()">Ø®Ø±ÙˆØ¬</button>
    </div>
  </nav>

  <!-- Tab Bar -->
  <div class="tab-bar">
    <button class="tab-btn active" onclick="showTab('home', this)">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button class="tab-btn" onclick="showTab('leaderboard', this)">ğŸ† Ø§Ù„Ù…ØªØµØ¯Ø±ÙˆÙ†</button>
    <button class="tab-btn" onclick="showTab('friends', this)">ğŸ‘¥ Ø§Ù„Ø£ØµØ­Ø§Ø¨</button>
  </div>

  <!-- ===== MAIN CONTENT ===== -->
  <div class="main-content">

    <!-- HOME TAB -->
    <div id="tab-home" class="tab-section active">
      <div class="my-stats-row">
        <div class="my-stat-card">
          <div class="my-stat-num" id="myStudyHours">0h</div>
          <div class="my-stat-label">ğŸ“š Ù…Ø°Ø§ÙƒØ±Ø©</div>
        </div>
        <div class="my-stat-card">
          <div class="my-stat-num" id="myPrayersCount">0/6</div>
          <div class="my-stat-label">ğŸ•Œ ØµÙ„ÙˆØ§Øª</div>
        </div>
        <div class="my-stat-card">
          <div class="my-stat-num" id="myQuranPages">0</div>
          <div class="my-stat-label">ğŸ“– ØµÙØ­Ø§Øª</div>
        </div>
      </div>

      <div class="input-grid">

        <!-- Timer Card -->
        <div class="glass-card">
          <div class="section-title"><div class="dot"></div> Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</div>
          <div class="timer-section">
            <div class="timer-circle-wrap">
              <svg class="timer-svg" width="220" height="220" viewBox="0 0 220 220">
                <defs>
                  <linearGradient id="timerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#4fc3f7"/>
                    <stop offset="100%" stop-color="#ce93d8"/>
                  </linearGradient>
                </defs>
                <circle class="timer-track" cx="110" cy="110" r="90"/>
                <circle id="timerCircle" cx="110" cy="110" r="90"/>
              </svg>
              <div class="timer-inner">
                <div class="timer-digits">
                  <span id="timerHours">00</span>:<span id="timerMins">00</span>:<span id="timerSecs">00</span>
                </div>
                <div id="timerStatus">ÙˆÙ‚Ù</div>
              </div>
            </div>
            <button class="timer-btn" id="timerBtn" onclick="toggleStudy()">â–¶ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</button>
          </div>
        </div>

        <!-- Prayers + Quran -->
        <div class="gap-md">

          <!-- Prayers -->
          <div class="glass-card">
            <div class="section-title"><div class="dot" style="background:var(--green)"></div> Ø§Ù„ØµÙ„ÙˆØ§Øª</div>
            <div class="prayers-grid">
              <button class="prayer-btn" data-prayer="Ø§Ù„ÙØ¬Ø±" onclick="togglePrayer('Ø§Ù„ÙØ¬Ø±')">ğŸŒ… Ø§Ù„ÙØ¬Ø±</button>
              <button class="prayer-btn" data-prayer="Ø§Ù„Ø¸Ù‡Ø±" onclick="togglePrayer('Ø§Ù„Ø¸Ù‡Ø±')">â˜€ï¸ Ø§Ù„Ø¸Ù‡Ø±</button>
              <button class="prayer-btn" data-prayer="Ø§Ù„Ø¹ØµØ±" onclick="togglePrayer('Ø§Ù„Ø¹ØµØ±')">ğŸŒ¤ Ø§Ù„Ø¹ØµØ±</button>
              <button class="prayer-btn" data-prayer="Ø§Ù„Ù…ØºØ±Ø¨" onclick="togglePrayer('Ø§Ù„Ù…ØºØ±Ø¨')">ğŸŒ† Ø§Ù„Ù…ØºØ±Ø¨</button>
              <button class="prayer-btn" data-prayer="Ø§Ù„Ø¹Ø´Ø§Ø¡" onclick="togglePrayer('Ø§Ù„Ø¹Ø´Ø§Ø¡')">ğŸŒ™ Ø§Ù„Ø¹Ø´Ø§Ø¡</button>
              <button class="prayer-btn" data-prayer="Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­" onclick="togglePrayer('Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­')">ğŸ•Œ Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­</button>
            </div>
          </div>

          <!-- Quran -->
          <div class="glass-card">
            <div class="section-title"><div class="dot" style="background:var(--accent2)"></div> Ù‚Ø±Ø¢Ù† Ø§Ù„ÙŠÙˆÙ…</div>
            <div class="quran-input-wrap">
              <input type="number" id="quranInput" class="quran-input" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª" min="0" max="604">
              <button class="save-btn" onclick="saveQuran()">ğŸ’¾ Ø­ÙØ¸</button>
            </div>
          </div>

        </div>

      </div>
    </div>

    <!-- LEADERBOARD TAB -->
    <div id="tab-leaderboard" class="tab-section">
      <div class="glass-card" style="margin-bottom:1.2rem">
        <div style="display:flex;align-items:center;gap:0.5rem;color:var(--sub);font-size:0.85rem">
          ğŸ—“ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª <strong style="color:var(--accent)" id="todayLabel"></strong> ÙÙ‚Ø·
        </div>
      </div>
      <div class="boards-grid">

        <!-- Study Board -->
        <div class="glass-card">
          <div class="board-title">ğŸ“š Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©</div>
          <div id="studyBoard"></div>
        </div>

        <!-- Prayers Board -->
        <div class="glass-card">
          <div class="board-title">ğŸ•Œ Ø§Ù„ØµÙ„ÙˆØ§Øª</div>
          <div id="prayersBoard"></div>
        </div>

        <!-- Quran Board -->
        <div class="glass-card" style="grid-column: 1 / -1">
          <div class="board-title">ğŸ“– Ø§Ù„Ù‚Ø±Ø¢Ù†</div>
          <div id="quranBoard" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:0.3rem"></div>
        </div>

      </div>
    </div>

    <!-- FRIENDS TAB -->
    <div id="tab-friends" class="tab-section">
      <div class="glass-card">
        <div class="section-title"><div class="dot"></div> Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµØ­Ø§Ø¨ Ø¯Ù„ÙˆÙ‚ØªÙŠ</div>
        <div class="friends-grid" id="friendsStatus"></div>
      </div>
    </div>

  </div>
</div>

<!-- ===== LOG MODAL ===== -->
<div class="modal" id="logModal" onclick="if(event.target===this)closeLogModal()">
  <div class="modal-box">
    <div class="modal-header">
      <h3 id="logModalTitle">Ø§Ù„Ø³Ø¬Ù„</h3>
      <button class="modal-close" onclick="closeLogModal()">âœ•</button>
    </div>
    <div class="modal-body" id="logContent"></div>
  </div>
</div>

<!-- ===== EDIT MODAL ===== -->
<div class="modal" id="editModal" onclick="if(event.target===this)closeEditModal()">
  <div class="modal-box">
    <div class="modal-header">
      <h3>âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h3>
      <button class="modal-close" onclick="closeEditModal()">âœ•</button>
    </div>
    <div class="modal-body">
      <div class="section-title" style="font-size:0.9rem;margin-bottom:0.7rem"><div class="dot" style="background:var(--green)"></div> Ø§Ù„ØµÙ„ÙˆØ§Øª</div>
      <div class="edit-checks">
        <label class="edit-check-item"><input type="checkbox" id="edit_Ø§Ù„ÙØ¬Ø±"> ğŸŒ… Ø§Ù„ÙØ¬Ø±</label>
        <label class="edit-check-item"><input type="checkbox" id="edit_Ø§Ù„Ø¸Ù‡Ø±"> â˜€ï¸ Ø§Ù„Ø¸Ù‡Ø±</label>
        <label class="edit-check-item"><input type="checkbox" id="edit_Ø§Ù„Ø¹ØµØ±"> ğŸŒ¤ Ø§Ù„Ø¹ØµØ±</label>
        <label class="edit-check-item"><input type="checkbox" id="edit_Ø§Ù„Ù…ØºØ±Ø¨"> ğŸŒ† Ø§Ù„Ù…ØºØ±Ø¨</label>
        <label class="edit-check-item"><input type="checkbox" id="edit_Ø§Ù„Ø¹Ø´Ø§Ø¡"> ğŸŒ™ Ø§Ù„Ø¹Ø´Ø§Ø¡</label>
        <label class="edit-check-item"><input type="checkbox" id="edit_Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­"> ğŸ•Œ Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­</label>
      </div>
      <div class="edit-field">
        <label class="edit-label">ğŸ“– ØµÙØ­Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†</label>
        <input type="number" id="editQuran" class="edit-input" min="0" max="604">
      </div>
      <div class="edit-field">
        <label class="edit-label">ğŸ“š Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© (Ù…Ø«Ø§Ù„: 2.5 = Ø³Ø§Ø¹ØªÙŠÙ† ÙˆÙ†Øµ)</label>
        <input type="number" id="editStudy" class="edit-input" min="0" max="24" step="0.1">
      </div>
      <button class="save-edit-btn" onclick="saveEditLog()">âœ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
function showTab(name, btn) {
  document.querySelectorAll('.tab-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + name).classList.add('active');
  btn.classList.add('active');

  if (name === 'leaderboard') {
    const d = new Date();
    document.getElementById('todayLabel').textContent =
      d.toLocaleDateString('ar-EG', { weekday: 'long', day: 'numeric', month: 'long' });
  }
}
</script>

</body>
</html>
